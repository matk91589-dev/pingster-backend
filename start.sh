#!/bin/bash

# ============================================
# ะะะะฃะกะ ะะกะะะ ะ ะคะะะ
# ============================================

cd /app

# ะฃะฑะธะฒะฐะตะผ ััะฐััะต ะฟัะพัะตััั
kill $(pgrep -f app.py) 2>/dev/null
kill $(pgrep -f bot.py) 2>/dev/null

# ะะฐะฟััะบะฐะตะผ Flask
nohup python3 app.py > flask.log 2>&1 &
echo "โ Flask ะทะฐะฟััะตะฝ (PID: $!)"

# ะะดัะผ 3 ัะตะบัะฝะดั
sleep 3

# ะะฐะฟััะบะฐะตะผ ะฑะพัะฐ
nohup python3 bot.py > bot.log 2>&1 &
echo "โ ะะพั ะทะฐะฟััะตะฝ (PID: $!)"

# ะะพะบะฐะทัะฒะฐะตะผ ะปะพะณะธ
echo ""
echo "๐ ะกะผะพััะตัั ะปะพะณะธ Flask:   tail -f /app/flask.log"
echo "๐ ะกะผะพััะตัั ะปะพะณะธ ะฑะพัะฐ:    tail -f /app/bot.log"
echo "๐ ะัะต ะฟัะพัะตััั:          pgrep -a python"
